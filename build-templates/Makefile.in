# DO NOT MODIFY!  This script is generated by configure.  Changes made
# here will be lost.  The source for this file is in ../Makefile.in.

# Copyright (c) 2008-2013 LG Electronics, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

vpath := $(srcdir)

srcdir := @abs_srcdir@
abs_builddir := @abs_builddir@

oecdir := $(srcdir)/oe-core
oecscripts := $(oecdir)/scripts

# should be set on the command line before using "make install"
INSTALLDIR = /dev/null

# PALMDIR is an absolute version of $(srcdir).
export PALMDIR := $(shell cd $(srcdir) && pwd)

BITBAKEDIR := $(PALMDIR)/bitbake/bin
BITBAKE := \
	unset LC_ALL; export LC_ALL; \
	LANG=en_US.UTF-8 \
	PATH=$(oecscripts):$(BITBAKEDIR):$$PATH \
	BUILDDIR=$(abs_builddir) \
	$(oecscripts)/bitbake

RSYNC := /usr/bin/rsync
RSYNC_FLAGS := -avxq --delete

# From oe-core, presumably for runqemu
export BB_ENV_EXTRAWHITE = MACHINE DISTRO TCMODE TCLIBC http_proxy ftp_proxy https_proxy all_proxy ALL_PROXY no_proxy SSH_AGENT_PID SSH_AUTH_SOCK BB_SRCREV_POLICY SDKMACHINE BB_NUMBER_THREADS PARALLEL_MAKE GIT_PROXY_COMMAND GIT_PROXY_IGNORE SOCKS5_PASSWD SOCKS5_USER WEBOS_DISTRO_BUILD_ID

### intended for command line use
BBFLAGS =

%:; $(BITBAKE) $(BBFLAGS) $*

define convenience
$(1)-$(2)-%:; cd BUILD-$(1) && $(TIME) $(MAKE) $(2)-$$*
endef

conveniences := \
	clean \
	cleanall \
	cleansstate \
	cleanreport \
	cmp \
	cmpall \
	compile \
	configure \
	fetch \
	fetchall \
	install \
	just \
	listtasks \
	package \
	patch \
	patchall \
	report \
	reportall \
	sanity \
	sanityall \
	thin \
	thinall \
	unpack \
	unpackall \

define convenience
$(1)-%:; $$(BITBAKE) $(BBFLAGS) -c $(1) $$*
endef

$(foreach c, $(conveniences),$(eval $(call convenience,$(c))))


# In most cases, "install-foo" is a coded request
# for 'bitbake -c install foo'.  However, at least one component has a
# name prefixed by "install-".  Hence the need for the "just-" target
# which lets us name "just-install-first" in order to request
# "install-first".  (Yes, I'm sorry it's complicated.)
just-%:; $(BITBAKE) $(BBFLAGS) $*

core-image-minimal:
all: core-image-minimal

ifeq ($(shell basename $(shell pwd)),BUILD-qemux86)
IMAGES :=
else
IMAGES := images/*$(CONTINUOUS_BUILD_MARK)*.tar
endif

install:
	[ -d $(INSTALLDIR) ] || mkdir -p $(INSTALLDIR)
	cd deploy && $(RSYNC) $(RSYNC_FLAGS) ipk $(IMAGES) $(INSTALLDIR)

installnew:
	[ -d $(INSTALLDIR) ] || mkdir -p $(INSTALLDIR)
	(cd deploy/ipk && tar cf - --newer $(INSTALLSINCE) .) | (cd $(INSTALLDIR) && tar xf -)

Makefile conf/local.conf conf/bblayers.conf: $(srcdir)/build-templates/Makefile.in $(srcdir)/build-templates/local-conf.in \
	$(srcdir)/build-templates/bblayers-conf.in
	./config.status
